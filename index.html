<!DOCTYPE html><html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>COMMUNITY AWARENESS FORUM - NGURU BRANCH</title>
<style>
body{margin:0;font-family:Arial,sans-serif;background:#fff;color:#111;}
header{background:#000;color:#fff;text-align:center;padding:20px;}
header h1{margin:0;font-weight:bold;}
header p{margin:5px 0 0;color:#c00;}
section{max-width:1000px;margin:20px auto;background:#fff;padding:20px;border-radius:10px;box-shadow:0 4px 12px rgba(0,0,0,0.1);}
.hidden{display:none;}
input,textarea,select{width:100%;padding:10px;margin:6px 0;border-radius:6px;border:1px solid #ccc;font-size:14px;}
button{padding:12px 18px;border:none;border-radius:6px;font-size:14px;cursor:pointer;background:#c00;color:#fff;}
button:hover{opacity:.9;}
.id-card{width:350px;margin:auto;padding:20px;border-radius:12px;background:#eee;color:#111;position:relative;}
.id-card .sign{margin-top:15px;border-top:1px solid #111;padding-top:5px;display:flex;justify-content:space-between;}
.id-card .sign span{flex:1;text-align:center;}
footer{text-align:center;margin-top:20px;font-size:12px;color:#555;}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:10px;}
#login, #dashboard{min-height:60vh;}
#login{display:flex;justify-content:center;align-items:center;}
#login .login-card{background:#fff;padding:30px;border-radius:12px;box-shadow:0 10px 25px rgba(0,0,0,.15);width:350px;text-align:center;}
#login h2{margin-bottom:20px;color:#00f;}
table{width:100%;border-collapse:collapse;margin-top:10px;}
table, th, td{border:1px solid #ccc;}
th, td{padding:8px;text-align:center;}
</style>
</head>
<body><!-- LOGIN PAGE --><section id="login">
<div class="login-card">
<h2>Member / Admin Login</h2>
<input id="luser" placeholder="Username (Email for members)">
<input id="lpass" type="password" placeholder="Password">
<select id="loginType">
<option value="member">Member</option>
<option value="admin">Admin</option>
</select>
<button onclick="login()">Login</button>
</div>
</section><!-- DASHBOARD --><section id="dashboard" class="hidden">
<header>
<h1>COMMUNITY AWARENESS FORUM</h1>
<p style="color:#00f;">Building Informed, United & Empowered Communities (Nguru Branch)</p>
</header>
<button onclick="logout()" style="float:right;background:#c00;">Logout</button>
<h2 style="color:#c00;">Dashboard</h2>
<div id="galleryArea">
<p>Upload Community Activity Photos:</p>
<input type="file" id="galleryUpload" multiple onchange="addGalleryImages()">
<div id="gallery" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:10px;margin-top:10px;"></div>
</div>
<div class="grid" style="margin-top:15px;">
<button onclick="show('register')">Register Member</button>
<button onclick="show('idcard')">View ID Card</button>
<button onclick="show('pending')">Pending Approvals</button>
<button onclick="show('projects')">Forum Projects</button>
<button onclick="show('attendance')">Attendance</button>
<button onclick="show('passwordChange')">Change Password</button>
</div>
<footer>All rights reserved &copy; CAF 2025</footer>
</section><!-- REGISTRATION FORM --><section id="register" class="hidden">
<h2>Membership Registration Form</h2>
<form id="regForm" onsubmit="return false;">
<input type="file" id="passport" accept="image/*" required>
<input placeholder="Full Name" id="fullname" required>
<input placeholder="Email Address" id="email" required>
<input placeholder="Phone Number" id="phone" required>
<input placeholder="Address" id="address" required>
<input placeholder="Position" id="position" required>
<input placeholder="Next of Kin Full Name" id="kinName" required>
<input placeholder="Next of Kin Phone Number" id="kinPhone" required>
<div>
<input type="checkbox" id="agree" required> I agree with the Terms, Constitution and Policies of CAF
</div>
<div class="sign">
<span>Chairman Signature</span>
<span>Secretary Signature</span>
</div>
<button onclick="submitRegistration()">Submit Registration</button>
</form>
</section><!-- ID CARD --><section id="idcard" class="hidden">
<h2>ID Card</h2>
<div class="id-card">
<img id="idPassport" src="" alt="Member Passport" style="width:80px;height:80px;border-radius:6px;position:absolute;top:20px;right:20px;">
<p id="idName" style="font-weight:bold;margin-top:10px;"></p>
<p id="idPosition"></p>
<p id="idEmail"></p>
<p id="idPhone"></p>
<div class="sign">
<span>Chairman</span>
<span>Member</span>
</div>
<button onclick="window.print()">Print ID Card</button>
</div>
</section><!-- PENDING APPROVALS --><section id="pending" class="hidden">
<h2>Pending Member Approvals</h2>
<table id="pendingTable">
<tr><th>Name</th><th>Email</th><th>Approve</th></tr>
</table>
</section><!-- PROJECTS --><section id="projects" class="hidden">
<h2>Forum Projects</h2>
<ul id="projectList">
<li>Community sensitization campaigns</li>
<li>Youth engagement programs</li>
<li>Outreach initiatives</li>
</ul>
</section><!-- ATTENDANCE --><section id="attendance" class="hidden">
<h2>Meeting Attendance</h2>
<input placeholder="Meeting Title">
<input type="date">
<input type="time">
<div style="height:50px;border:1px dashed #000;margin-top:10px;">Signature</div>
<button onclick="window.print()">Print Attendance</button>
</section><!-- PASSWORD CHANGE --><section id="passwordChange" class="hidden">
<h2>Change Password</h2>
<input type="password" id="oldPass" placeholder="Current Password">
<input type="password" id="newPass" placeholder="New Password">
<button onclick="changePassword()">Change Password</button>
</section><script>
let pendingMembers=[];
let approvedMembers=[];
let memberCount=0;
let currentUser=null;
let currentUserType=null;
const adminCreds={username:'cafreg',password:'caf7353'};

function login(){
  const username=document.getElementById('luser').value;
  const password=document.getElementById('lpass').value;
  const type=document.getElementById('loginType').value;
  if(type==='admin'){
    if(username===adminCreds.username && password===adminCreds.password){currentUser=username; currentUserType='admin'; showDashboard();}
    else alert('Invalid admin credentials');
  } else {
    const member=approvedMembers.find(m=>m.email===username && m.password===password);
    if(member){currentUser=username; currentUserType='member'; showDashboard(); generateIDCard(member);}
    else alert('Invalid member credentials or not approved yet');
  }
}

function logout(){currentUser=null; currentUserType=null; document.querySelectorAll('section').forEach(s=>s.classList.add('hidden')); document.getElementById('login').classList.remove('hidden');}
function showDashboard(){document.querySelectorAll('section').forEach(s=>s.classList.add('hidden')); document.getElementById('dashboard').classList.remove('hidden');}
function show(id){if(!currentUser){alert('Please login first'); return;} document.querySelectorAll('section').forEach(s=>s.classList.add('hidden')); document.getElementById('dashboard').classList.remove('hidden'); document.getElementById(id).classList.remove('hidden');}

function submitRegistration(){
  let member={fullname:document.getElementById('fullname').value,email:document.getElementById('email').value,phone:document.getElementById('phone').value,address:document.getElementById('address').value,position:document.getElementById('position').value,kinName:document.getElementById('kinName').value,kinPhone:document.getElementById('kinPhone').value,passport:document.getElementById('passport').files[0],password:'caf1234'};
  pendingMembers.push(member);
  alert('Registration submitted! Waiting for admin approval.'); document.getElementById('regForm').reset(); updatePendingTable();
}

function updatePendingTable(){
  const table=document.getElementById('pendingTable'); table.innerHTML='<tr><th>Name</th><th>Email</th><th>Approve</th></tr>';
  pendingMembers.forEach((m,i)=>{let row=table.insertRow(); row.insertCell(0).innerText=m.fullname; row.insertCell(1).innerText=m.email; let btn=document.createElement('button'); btn.innerText='Approve'; btn.onclick=()=>approveMember(i); row.insertCell(2).appendChild(btn);});
}

function approveMember(index){
  memberCount++; let member=pendingMembers.splice(index,1)[0]; member.cafID='CAF-2025-'+String(memberCount).padStart(3,'0'); approvedMembers.push(member);
  alert('Member approved! Username: '+member.email+' Password: caf1234'); updatePendingTable();
}

function generateIDCard(member){
  if(member.passport){let reader=new FileReader(); reader.onload=e=>document.getElementById('idPassport').src=e.target.result; reader.readAsDataURL(member.passport);}
  document.getElementById('idName').innerText=member.fullname+' (CAF)';
  document.getElementById('idPosition').innerText='Position: '+member.position;
  document.getElementById('idEmail').innerText='Email: '+member.email;
  document.getElementById('idPhone').innerText='Phone: '+member.phone;
}

function changePassword(){const oldPass=document.getElementById('oldPass').value; const newPass=document.getElementById('newPass').value;
if(currentUserType==='admin'){if(oldPass===adminCreds.password){adminCreds.password=newPass; alert('Admin password changed');} else alert('Incorrect current password');} else {let member=approvedMembers.find(m=>m.email===currentUser); if(member.password===oldPass){member.password=newPass; alert('Password changed');} else alert('Incorrect current password');}}

function addGalleryImages(){let files=document.getElementById('galleryUpload').files; let gallery=document.getElementById('gallery'); gallery.innerHTML=''; for(let f of files){let reader=new FileReader(); reader.onload=function(e){let img=document.createElement('img'); img.src=e.target.result; img.style.width='100%'; img.style.borderRadius='8px'; gallery.appendChild(img);}; reader.readAsDataURL(f);}}
</script></body>
</html>
